{
  "_args": [
    [
      {
        "raw": "two-step@latest",
        "scope": null,
        "escapedName": "two-step",
        "name": "two-step",
        "rawSpec": "latest",
        "spec": "latest",
        "type": "tag"
      },
      "/media/seal_7/New Volume/NODE/WORK/idetry1"
    ]
  ],
  "_from": "two-step@latest",
  "_id": "two-step@0.0.4",
  "_inCache": true,
  "_location": "/two-step",
  "_npmUser": {
    "name": "xavi",
    "email": "xavi.rmz@gmail.com"
  },
  "_npmVersion": "1.3.11",
  "_phantomChildren": {},
  "_requested": {
    "raw": "two-step@latest",
    "scope": null,
    "escapedName": "two-step",
    "name": "two-step",
    "rawSpec": "latest",
    "spec": "latest",
    "type": "tag"
  },
  "_requiredBy": [
    "/"
  ],
  "_resolved": "https://registry.npmjs.org/two-step/-/two-step-0.0.4.tgz",
  "_shasum": "610c757185a16d4b1cf174ed90478a617c4c1da8",
  "_shrinkwrap": null,
  "_spec": "two-step@latest",
  "_where": "/media/seal_7/New Volume/NODE/WORK/idetry1",
  "bugs": {
    "url": "https://github.com/xavi-/two-step/issues"
  },
  "dependencies": {},
  "description": "TwoStep is the spiritual successor of Step with better error handling and finer flow control",
  "devDependencies": {},
  "directories": {},
  "dist": {
    "shasum": "610c757185a16d4b1cf174ed90478a617c4c1da8",
    "tarball": "https://registry.npmjs.org/two-step/-/two-step-0.0.4.tgz"
  },
  "engines": {
    "node": ">= 0.3.1"
  },
  "homepage": "https://github.com/xavi-/two-step#readme",
  "keywords": [
    "flow control",
    "step",
    "async"
  ],
  "main": "./index.js",
  "maintainers": [
    {
      "name": "xavi",
      "email": "xavi.rmz@gmail.com"
    }
  ],
  "name": "two-step",
  "optionalDependencies": {},
  "readme": "# TwoStep\n\nTwoStep is the spiritual successor of [Step](https://github.com/creationix/step) with better error handling and finer flow control.  Much of the inspiration and direction for this project came from this gist: https://gist.github.com/1524578\n\n## The API and Examples\n\nThe `TwoStep` function takes any number of callbacks as parameters.  By default, the callbacks are executed one right after another in the sequence they were passed in.  The goal is to reduce the nesting that commonly occurs when chaining several asynchronous functions.  The `this` pointer in each callback is a object with the following api:\n\n- **this.val([param-name])** -- returns a callback that expects an error object (or null if no error occurred) as the first parameter and a results as the second parameter.  Note, this function (as well most other functions in this API) can be called multiple time in a single callback.  Each `this.val` call corresponds to an addition parameter passed to the next callback.  For example, here's how `this.val` can be used to asynchronously read in two files:\n\n\t```javascript\n\tTwoStep(\n\t\tfunction readSelf() {\n\t\t\tfs.readFile(\"./my-file1.txt\", this.val(\"file1\"));\n\t\t\tfs.readFile(\"./my-file2.txt\", this.val(\"file2\"));\n\t\t},\n\t\tfunction(err, text1, text2) {\n\t\t\t// text1 is the contents for my-file1.txt\n\t\t\t// text2 is the contents for my-file2.txt\n\t\t}\n\t);\n\t```\nAn optional string parameter can passed in to `this.val` as well.  This string can aid with error handling and debugging. (See Error Handleing section)  Note nearly every function in `TwoStep` takes the same optional string as the final parameter.\n- **this.syncVal(value, [param-name])** -- used to pass a synchronously calulated result to the next callback.  Here's an example of how it could be used:\n\n\t```javascript\n\tvar userId = /* ...  some value ... */;\n\tTwoStep(\n\t\tfunction getProfile() {\n\t\t\tif(userId in profileCache) {\n\t\t\t\tthis.syncVal(profileCache[userId]);\n\t\t\t} else {\n\t\t\t\tprofileDB.get(userId, this.val());\n\t\t\t}\n\t\t},\n\t\tfunction renderProfile(err, profile) { /* ... render it ... */ }\n\t);\n\t```\n- **this.valArray([param-name])** -- used when there are a variable number of callbacks.  Returns an object with two functions: `obj.val` and `obj.syncVal`.  These two function work very similar to the top level `this.val` and `this.syncVal` in that calling either results in another item being placed in a list.  This is useful, for example, when you need to retrieve multiple user profiles from a database:\n\n\t```javascript\n\tvar userIds = [ /* ... list of ids ... */ ];\n\tTwoStep(\n\t\tfunction getProfiles() {\n\t\t\tvar profiles = this.valArray();\n\n\t\t\tfor(var i = 0; i < userIds.length; i++) {\n\t\t\t\tvar userId = userIds[i];\n\n\t\t\t\tif(userId in profileCache) {\n\t\t\t\t\tprofiles.syncVal(profileCache[userId]);\n\t\t\t\t} else {\n\t\t\t\t\tprofileDB.get(userId, profiles.val());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfunction renderProfiles(err, profiles) { /* ... render it ... */ }\n\t);\n\t```\n- **this.data** -- an persistent object that is available to each TwoStep callback.\n\n\t```javascript\n\tTwoStep(\n\t\tfunction parseUser() { this.data.userId = \"123\"; },\n\t\tfunction getProfile(err, user) { /* get the profile */ },\n\t\tfunction renderProfile(err, profile) {\n\t\t\t// this.data.userId === \"123\"\n\t\t}\n\t);\n\t```\n- **this.listen(EventEmitter, [param-name])** -- a convenience function that takes an event emitter and listens for `data`, `error` and `end` events on it, then passes the results to the next callback.\n\n\t```javascript\n\tTwoStep(\n\t\tfunction() { // Accumulates data from stdin\n\t\t\tthis.listen(process.stdin); // Listens for the data, error, end events\n\t\t},\n\t\tfunction(err, chunks) {\n\t\t\t// chunks is arrays of buffers/strings emitted during the \"data\" event\n\t\t}\n\t);\n\t```\n- **this.jumpTo(string, [argsArray])** -- allows you to jump to any named function in the current step chain\n- **this.jumpTo(function, [argsArray])** -- exits the current step chain and asynchronously call an outside function\n\n\t```javascript\n\tfunction badNews(err) {\n\t\t// Damage control...\n\t}\n\n\tTwoStep(\n\t\tfunction parseData() { /* ... something ... */ },\n\t\tfunction modifyUserData(err, val) {\n\t\t\tif(err.message === \"expired key\") { return this.jumpTo(\"cleanup\", [ err ]); }\n\t\t\t// Modify user data\n\t\t},\n\t\tfunction saveData(err, val) {\n\t\t\t// Completely stops the Step chain\n\t\t\t// calls `badNews` function with `err` as args list\n\t\t\tif(err) { return this.jumpTo(badNews, [ err ]); }\n\t\t\t// ...\n\t\t},\n\t\tfunction cleanUp(err, val) {\n\t\t\tif(err.message === \"expired key\") { /* Prune stale cache */ }\n\t\t\t// Invalidate keys\n\t\t}\n\t);\n\t```\n\nSee `test/*.js` for more working examples.\n\n### Error Handling\n\nIn the hopes to improve debuggability, TwoStep allows users to give each callback a name.  When and if an error occurs this name (along with other information) is used to create a \"step info object\" which is then attatched to the original error object.  The \"step info object\" contains the name of the callback, which step the exception occurred as well the index of the parameter that was being calculated.  Here's an example:\n\n```javascript\nTwoStep(\n\tfunction callDB() {\n\t\tuserdb.get(userId, this.val(\"user-data\"));\n\t\tproductdb.get(productId, this.val(\"product-data\"));\n\t},\n\tfunction processPage(err, user, product) {\n\t\tif(err) {\n\t\t\t// err.step === { name: \"callDB\", paramName: \"user-data\", paramIdx: 1 }\n\t\t}\n\n\t\t/* ... process page ... */\n\t},\n\t// ...\n);\n```\n\nEvery TwoStep function (with the exception of `jumpTo`) takes an optional string as the final parameter.  This string is used to set the `paramName` property on the \"step info object\".\n\n## Getting TwoStep\n\nThe easiest way to get TwoStep is with [npm](http://npmjs.org/):\n\n\tnpm install two-step\n\nAlternatively you can clone this git repository:\n\n\tgit clone git://github.com/xavi-/two-step.git\n\n## Developed by\n* Xavi Ramirez\n\n## License\nThis project is released under [The MIT License](http://www.opensource.org/licenses/mit-license.php).\n",
  "readmeFilename": "README.markdown",
  "repository": {
    "type": "git",
    "url": "git://github.com/xavi-/two-step.git"
  },
  "version": "0.0.4"
}
